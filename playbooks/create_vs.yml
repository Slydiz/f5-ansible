---
- name: VS
  hosts: f5
  gather_facts: no
  collections:
    - f5networks.f5_modules

  vars_files:
    - ../group_vars/f5.yml

  vars:
    # Personnaliser selon vos besoins
    vs_name: "vs-test"
    vs_destination: "10.69.238.220"
    vs_port: 80
    vs_traffic_group: "/Common/traffic-group-1"  # ou traffic-group-2

  tasks:
    - name: "Cr√©er VS sur {{ vs_traffic_group }}"
      bigip_virtual_server:
        provider: "{{ f5_provider }}"
        name: "{{ vs_name }}"
        destination: "{{ vs_destination }}"
        port: "{{ vs_port }}"
        description: "VS on {{ vs_traffic_group }}"
        snat: automap
        traffic_group: "{{ vs_traffic_group }}"
        partition: Common
        state: present
      delegate_to: localhost